"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[979],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=c(n),h=i,f=d["".concat(l,".").concat(h)]||d[h]||u[h]||a;return n?r.createElement(f,s(s({ref:t},p),{},{components:n})):r.createElement(f,s({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,s=new Array(a);s[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:i,s[1]=o;for(var c=2;c<a;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9588:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var r=n(7462),i=(n(7294),n(3905));const a={id:"utility_scripts",title:"Utility Scripts",sidebar_position:8},s="Python utility scripts for easier interaction with the service",o={unversionedId:"utility_scripts",id:"utility_scripts",title:"Utility Scripts",description:"| Script | Description | Shortcut |",source:"@site/docs/utility_scripts.md",sourceDirName:".",slug:"/utility_scripts",permalink:"/argo-api-authn/docs/utility_scripts",draft:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{id:"utility_scripts",title:"Utility Scripts",sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"Errors",permalink:"/argo-api-authn/docs/api_errors"}},l={},c=[{value:"Configuration",id:"configuration",level:2},{value:"Requirements",id:"requirements",level:2}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"python-utility-scripts-for-easier-interaction-with-the-service"},"Python utility scripts for easier interaction with the service"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Script"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Shortcut"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"ams-create-users-gocdb.py"),(0,i.kt)("td",{parentName:"tr",align:null},"Python script that creates ams users and binding."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#ams-create-users-gocdb"},"Details"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"ams-create-users-cloud-info.py"),(0,i.kt)("td",{parentName:"tr",align:null},"Python script that creates ams users, binding and topics per site."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#ams-create-users-cloud-info"},"Details"))))),(0,i.kt)("a",{id:"ams-create-users-gocdb"}),"AMS Create users from goc db script:",(0,i.kt)("p",null,"Python utility script that takes the xml feed from goc db,creates the respective\nams users under the specified project, assigns to the correct project's topic and\nfinally creates the binding for each user, using the dn from goc db."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ams-create-users-gocdb.py -c <ConfigPath> -verify")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"-c : Path to an appropriate config file.If not specified\nit will first look at /etc/argo-api-authn/conf.d/ams-users-create-gocdb.cfg\nand then will look at projects conf folder")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"-verify: If specified all the requests will check the validity of the ssl certificate")),(0,i.kt)("a",{id:"ams-create-users-cloud-info"}),"AMS Create users and topics per site:",(0,i.kt)("p",null,"Python utility script that takes an xml feed from goc db, creates the respective\nams users under the specified project, assigns to the correct project's topic,\ncreates the binding for each user, using the dn from goc db and finally creates\ntopics with the schema SITE","_",(0,i.kt)("inlineCode",{parentName:"p"},"sitename"),"_","ENDPOINT","_",(0,i.kt)("inlineCode",{parentName:"p"},"id_in_gocdb"),"."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ams-create-users-cloud-info.py -c <ConfigPath> -verify")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"-c : Path to an appropriate config file.If not specified\nit will first look at /etc/argo-api-authn/conf.d/ams-create-users-cloud-info.cfg\nand then will look at projects conf folder")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"-verify: If specified all the requests will check the validity of the ssl certificate")),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"ams-create-users-gocdb.template")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"ams-create-users-cloud-info.template"),"\nrespectively to produce your conf file.\nThe project should exist in AMS in advance.\nThe service types specified should also be present as topics in ams under the specified project"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-buildoutcfg"},"[AMS]\n# under which ams project, the users will be created\nams_project:\n# goc db url to pull user data\ngoc_db_host:\n# service types referes to the different service types that will we should keep from the xml and assign them to the respectivew ams topic \nservice-types:\n# cert to access gocdb\ncert: /path/to/cert\ncert_key: /path/to/key\n# ams use role\nusers_role: publisher\n# token to access ams\nams_token:\n# ams url\nams_host:\n# ams user email - since we don't get an email from goc db, we can use this field as a wildcard, to identify which users were created with this script\nams_email: goc_db_user\n\n[AUTHN]\n# token to access authn\nauthn_token:\n# authn url to create bindings\nauthn_host: \n# service's uuid where bindings will belong\nservice_uuid:\n# service's host where bindings will belong\nservice_host:\n\n[LOGS]\nsyslog_socket:\n")),(0,i.kt)("h2",{id:"requirements"},"Requirements"),(0,i.kt)("p",null,"There is a requirements.txt file inside the repo's ",(0,i.kt)("inlineCode",{parentName:"p"},"bin")," folder that specifies which dependencies are needed."),(0,i.kt)("p",null,"If you don't want to manually handle the dependencies, you can use the setup.py script in the root folder of the repo."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"python setup.py install"),"  "),(0,i.kt)("p",null,"OR"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"pip install git+https://github.com/ARGOeu/argo-api-authn.git@devel")," for the latest release"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"pip install git+https://github.com/ARGOeu/argo-api-authn.git")," for the stable release"),(0,i.kt)("p",null,"After installing the script's package, you can find them in the ",(0,i.kt)("inlineCode",{parentName:"p"},"/usr/bin")," or if you are using a virtualenv in the ",(0,i.kt)("inlineCode",{parentName:"p"},"bin")," folder of the virtualenv."),(0,i.kt)("p",null,"In addition, if you want to use them in other scripts, you will can import them:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"import argo_api_authn_scripts   \n")))}u.isMDXComponent=!0}}]);